<!DOCTYPE html>
<html lang="id">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  <title id="page-title">Toko Digital | Mini Commerce</title>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <script>
Â  Â  // Konfigurasi Tailwind CSS untuk menggunakan font Inter dan palet warna kustom
Â  Â  tailwind.config = {
Â  Â  Â  theme: {
Â  Â  Â  Â  extend: {
Â  Â  Â  Â  Â  colors: {
Â  Â  Â  Â  Â  Â  primary: {
Â  Â  Â  Â  Â  Â  Â  50: '#f5f7ff',
Â  Â  Â  Â  Â  Â  Â  100: '#eef1ff',
Â  Â  Â  Â  Â  Â  Â  200: '#d9e0ff',
Â  Â  Â  Â  Â  Â  Â  300: '#b0bfff',
Â  Â  Â  Â  Â  Â  Â  400: '#869aff',
Â  Â  Â  Â  Â  Â  Â  500: '#5c78ff', // Warna Biru Utama
Â  Â  Â  Â  Â  Â  Â  600: '#435eff',
Â  Â  Â  Â  Â  Â  Â  700: '#3248c0',
Â  Â  Â  Â  Â  Â  Â  800: '#23338c',
Â  Â  Â  Â  Â  Â  Â  900: '#151e5e',
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  accent: '#10b981', // Hijau untuk Aksi
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  },
Â  Â  Â  Â  fontFamily: {
Â  Â  Â  Â  Â  sans: ['Inter', 'sans-serif'],
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  </script>
Â  Â  <style>
Â  Â  .icon-cart:before { content: "ğŸ›’"; margin-right: 0.5rem; }
Â  Â  .icon-back:before { content: "â†"; margin-right: 0.5rem; }
Â  </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans min-h-screen flex flex-col">
Â  <div class="container mx-auto p-4 md:p-8 max-w-7xl flex-grow">
Â  Â  Â  Â  <header class="mb-8 p-4 bg-white shadow-lg rounded-xl flex justify-between items-center">
Â  Â  Â  <a href="/" class="block flex items-center gap-3 hover:opacity-90 transition" onclick="event.preventDefault(); history.pushState(null, '', '/'); router();">
Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 20l-1 1h8l-1-1v-3.25m-7.5 0h15a3 3 0 003-3V8.75a3 3 0 00-3-3h-15a3 3 0 00-3 3V14a3 3 0 003 3.25z" />
Â  Â  Â  Â  </svg>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <h1 class="text-2xl font-extrabold text-gray-900">Mini Commerce</h1>
Â  Â  Â  Â  Â  <p class="text-sm text-gray-500 mt-0.5 hidden sm:block">Produk digital siap diunduh.</p>
Â  Â  Â  Â  </div>
Â  Â  Â  </a>
Â  Â  Â  <a href="/admin/login" class="text-sm text-gray-600 hover:text-primary-600 font-semibold transition">Login Admin</a>
Â  Â  </header>

Â  Â  Â  Â  <div id="product-list-page" class="transition-opacity duration-300">
Â  Â  Â  <section id="controls" class="mb-8 bg-white p-4 md:p-6 rounded-xl shadow-lg">
Â  Â  Â  Â  <h2 class="text-xl font-bold text-gray-800 mb-4">Jelajahi Produk Kami</h2>
Â  Â  Â  Â  <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
Â  Â  Â  Â  Â  <div class="flex items-center gap-3 flex-wrap">
Â  Â  Â  Â  Â  Â  <input id="search" type="search" placeholder="Cari produk digital..." class="px-4 py-2 rounded-xl border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-primary-500 w-full lg:w-64 transition" />
Â  Â  Â  Â  Â  Â  <div id="category-pills" class="flex gap-2 overflow-x-auto py-1 whitespace-nowrap"></div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="text-sm text-gray-500 font-medium self-start lg:self-auto">
Â  Â  Â  Â  Â  Â  <span id="result-count" class="bg-primary-50 text-primary-700 px-3 py-1 rounded-full">Memuat...</span>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </section>

Â  Â  Â  <main>
Â  Â  Â  Â  <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
Â  Â  Â  Â  Â  <template id="skeleton">
Â  Â  Â  Â  Â  Â  <div class="animate-pulse p-6 bg-white rounded-xl shadow-lg border border-gray-100">
Â  Â  Â  Â  Â  Â  Â  <div class="w-full h-48 bg-gray-200 rounded-lg mb-4"></div>
Â  Â  Â  Â  Â  Â  Â  <div class="h-5 bg-gray-200 rounded w-3/4 mb-2"></div>
Â  Â  Â  Â  Â  Â  Â  <div class="h-4 bg-gray-200 rounded w-1/2 mb-4"></div>
Â  Â  Â  Â  Â  Â  Â  <div class="h-10 bg-primary-200 rounded-lg w-full"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </template>

Â  Â  Â  Â  Â  <div id="loading-container" class="col-span-full">
Â  Â  Â  Â  Â  Â  <div class="p-6 bg-white rounded-xl shadow-lg text-center text-primary-600 font-semibold">Memuat produk...</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="error-area" class="mt-8 hidden">
Â  Â  Â  Â  Â  <p class="text-red-600 bg-red-50 border border-red-200 p-4 rounded-xl text-center font-medium">Gagal memuat produk. Silakan coba refresh.</p>
Â  Â  Â  Â  </div>
Â  Â  Â  </main>
Â  Â  </div>

Â  Â  Â  Â  <div id="product-detail-page" class="hidden transition-opacity duration-300">
Â  Â  Â  Â  Â  </div>
Â  </div>

Â  Â  <footer class="mt-12 border-t border-gray-200 py-6 bg-white">
Â  Â  <div class="container mx-auto max-w-7xl px-4 md:px-8 text-center text-sm text-gray-500">
Â  Â  Â  <p>&copy; 2025 Mini Commerce. Dibuat dengan Hono & Cloudflare Pages.</p>
Â  Â  </div>
Â  </footer>

Â  <script>
Â  Â  function escapeHtml(str) {
Â  Â  Â  if (typeof str !== 'string') return str == null ? '' : String(str);
Â  Â  Â  return str.replace(/[&<>"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]);
Â  Â  }

Â  Â  async function parseJsonResponse(res) {
Â  Â  Â  const txt = await res.text();
Â  Â  Â  try { return { ok: res.ok, json: JSON.parse(txt), raw: txt }; }
Â  Â  Â  catch { return { ok: res.ok, json: null, raw: txt }; }
Â  Â  }

Â  Â  // --- Konstan & Elemen ---
Â  Â  const API_PRODUCTS = '/api/store/products';
Â  Â  const API_PRODUCT_BY_SLUG = '/api/store/products/slug/';

Â  Â  const pageTitleEl = document.getElementById('page-title');
Â  Â  const productListPage = document.getElementById('product-list-page');
Â  Â  const productDetailPage = document.getElementById('product-detail-page');

Â  Â  // Elemen Halaman List
Â  Â  const productListEl = document.getElementById('product-list');
Â  Â  const skeletonTmpl = document.getElementById('skeleton');
Â  Â  const errorArea = document.getElementById('error-area');
Â  Â  const searchInput = document.getElementById('search');
Â  Â  const categoryPills = document.getElementById('category-pills');
Â  Â  const resultCount = document.getElementById('result-count');

Â  Â  let products = [], filtered = [], categories = ['Semua'];

Â  Â  // --- Logic Halaman List ---

Â  Â  function renderSkeletons(count = 6) {
Â  Â  Â  productListEl.innerHTML = '';
Â  Â  Â  for (let i = 0; i < count; i++) {
Â  Â  Â  Â  const node = skeletonTmpl.content.cloneNode(true);
Â  Â  Â  Â  productListEl.appendChild(node);
Â  Â  Â  }
Â  Â  }

Â  Â  function renderProducts(list) {
Â  Â  Â  productListEl.innerHTML = '';
Â  Â  Â  if (!list || list.length === 0) {
Â  Â  Â  Â  productListEl.innerHTML = '<div class="col-span-full p-6 bg-white rounded-xl shadow text-center text-gray-500">Belum ada produk yang ditemukan.</div>';
Â  Â  Â  Â  resultCount.textContent = '0 produk';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  list.forEach(p => {
Â  Â  Â  Â  const img = escapeHtml(p.image_url || 'https://placehold.co/600x400/f3f4f6/9ca3af?text=Produk+Digital');
Â  Â  Â  Â  const name = escapeHtml(p.name || 'â€”');
Â  Â  Â  Â  const category = escapeHtml(p.category_name || 'Tanpa Kategori');
Â  Â  Â  Â  const price = (typeof p.price === 'number' || !isNaN(Number(p.price))) ? new Intl.NumberFormat('id-ID').format(Number(p.price)) : '-';
Â  Â  Â  Â  const slugOrId = encodeURIComponent(p.slug || p.id);
Â  Â  Â  Â  const href = `/product/${slugOrId}`;

Â  Â  Â  Â  const card = document.createElement('article');
Â  Â  Â  Â  card.className = 'bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100 transition-all duration-300 hover:shadow-xl hover:-translate-y-0.5';
Â  Â  Â  Â  
Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  <a href="${href}" class="block" onclick="event.preventDefault(); history.pushState(null, '', '${href}'); router();">
Â  Â  Â  Â  Â  Â  <div class="w-full h-48 bg-gray-100 overflow-hidden">
Â  Â  Â  Â  Â  Â  Â  <img loading="lazy" src="${img}" alt="${name}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-[1.03]">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="p-5">
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xs font-semibold text-primary-600 bg-primary-50 px-3 py-1 rounded-full">${category}</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-lg font-bold text-accent">Rp ${price}</span>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <h3 class="text-xl font-bold mt-3 truncate text-gray-900">${name}</h3>
Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-sm text-gray-500 line-clamp-2">${escapeHtml(p.description || 'Deskripsi belum tersedia.')}</p>
Â  Â  Â  Â  Â  Â  Â  <div class="mt-5">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="w-full inline-flex items-center justify-center gap-2 bg-primary-600 text-white py-2.5 px-4 rounded-lg shadow-md hover:bg-primary-700 focus:outline-none focus:ring-4 focus:ring-primary-300 font-semibold transition">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Beli Sekarang
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  `;
Â  Â  Â  Â  productListEl.appendChild(card);
Â  Â  Â  });
Â  Â  Â  resultCount.textContent = `${list.length} produk`;
Â  Â  }

Â  Â  function renderCategoryPills() {
Â  Â  Â  categoryPills.innerHTML = '';
Â  Â  Â  categories.forEach(cat => {
Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  btn.type = 'button';
Â  Â  Â  Â  btn.textContent = cat;
Â  Â  Â  Â  btn.className = 'px-4 py-1.5 rounded-full text-sm font-medium border-2 border-gray-200 bg-white text-gray-700 hover:bg-primary-50 hover:text-primary-700 whitespace-nowrap transition-colors duration-200';
Â  Â  Â  Â  if (cat === 'Semua') btn.classList.add('bg-primary-600', 'text-white', 'border-primary-600', 'hover:bg-primary-700', 'hover:text-white');
Â  Â  Â  Â  btn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Array.from(categoryPills.children).forEach(c => {
Â  Â  Â  Â  Â  Â  c.classList.remove('bg-primary-600','text-white','border-primary-600', 'hover:bg-primary-700', 'hover:text-white');
Â  Â  Â  Â  Â  Â  c.classList.add('bg-white', 'text-gray-700', 'border-gray-200', 'hover:bg-primary-50', 'hover:text-primary-700');
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  btn.classList.remove('bg-white', 'text-gray-700', 'border-gray-200', 'hover:bg-primary-50', 'hover:text-primary-700');
Â  Â  Â  Â  Â  btn.classList.add('bg-primary-600','text-white','border-primary-600', 'hover:bg-primary-700', 'hover:text-white');
Â  Â  Â  Â  Â  filterByCategory(cat);
Â  Â  Â  Â  });
Â  Â  Â  Â  categoryPills.appendChild(btn);
Â  Â  Â  });
Â  Â  }

Â  Â  function filterByCategory(cat) {
Â  Â  Â  if (cat === 'Semua') applySearch(products);
Â  Â  Â  else applySearch(products.filter(p => (p.category_name || 'Tanpa Kategori') === cat));
Â  Â  }

Â  Â  function applySearch(list) {
Â  Â  Â  const q = (searchInput.value || '').trim().toLowerCase();
Â  Â  Â  if (!q) filtered = list.slice();
Â  Â  Â  else filtered = list.filter(p => ((p.name||'').toLowerCase().includes(q) || (p.description||'').toLowerCase().includes(q) || (p.category_name||'').toLowerCase().includes(q)));
Â  Â  Â  renderProducts(filtered);
Â  Â  }

Â  Â  async function loadProducts() {
Â  Â  Â  productListPage.classList.remove('hidden', 'opacity-0');
Â  Â  Â  productDetailPage.classList.add('hidden', 'opacity-0');
Â  Â  Â  pageTitleEl.textContent = 'Toko Digital | Mini Commerce';

Â  Â  Â  errorArea.classList.add('hidden');
Â  Â  Â  renderSkeletons(8); // Tampilkan 8 skeleton
Â  Â  Â  try {
Â  Â  Â  Â  const res = await fetch(API_PRODUCTS);
Â  Â  Â  Â  const parsed = await parseJsonResponse(res);
Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  console.error('Load products error:', parsed.raw || parsed.json || res.status);
Â  Â  Â  Â  Â  productListEl.innerHTML = '<div class="col-span-full p-6 bg-red-50 rounded-xl shadow border border-red-200 text-center text-red-700 font-medium">Gagal memuat produk.</div>';
Â  Â  Â  Â  Â  errorArea.classList.remove('hidden'); resultCount.textContent = '0 produk'; return;
Â  Â  Â  Â  }
Â  Â  Â  Â  const data = Array.isArray(parsed.json) ? parsed.json : (parsed.json && (parsed.json.data || parsed.json.results || parsed.json.items)) || [];
Â  Â  Â  Â  products = data.map(p => ({ id: p.id, slug: p.slug, name: p.name, description: p.description, price: p.price, image_url: p.image_url, category_name: p.category_name || p.category }));
Â  Â  Â  Â  const set = new Set();
Â  Â  Â  Â  products.forEach(p => set.add(p.category_name || 'Tanpa Kategori'));
Â  Â  Â  Â  categories = ['Semua', ...Array.from(set).filter(Boolean).sort((a,b)=>a.localeCompare(b))];
Â  Â  Â  Â  renderCategoryPills();
Â  Â  Â  Â  applySearch(products);
Â  Â  Â  } catch (err) {
Â  Â  Â  Â  console.error('Unexpected error loading products', err);
Â  Â  Â  Â  productListEl.innerHTML = '<div class="col-span-full p-6 bg-red-50 rounded-xl shadow border border-red-200 text-center text-red-700 font-medium">Gagal memuat produk.</div>';
Â  Â  Â  Â  errorArea.classList.remove('hidden'); resultCount.textContent = '0 produk';
Â  Â  Â  }
Â  Â  }

Â  Â  // --- Logic Halaman Detail Produk Baru ---

Â  Â  function renderProductDetail(p) {
Â  Â  Â  productDetailPage.classList.remove('hidden', 'opacity-0');
Â  Â  Â  productListPage.classList.add('hidden', 'opacity-0');
Â  Â  Â  pageTitleEl.textContent = `${p.name} | Toko Digital`;

Â  Â  Â  const img = escapeHtml(p.image_url || 'https://placehold.co/800x600/f3f4f6/9ca3af?text=Produk+Digital');
Â  Â  Â  const price = (typeof p.price === 'number' || !isNaN(Number(p.price))) ? new Intl.NumberFormat('id-ID').format(Number(p.price)) : '-';
Â  Â  Â  
Â  Â  Â  productDetailPage.innerHTML = `
Â  Â  Â  Â  <a href="/" class="icon-back text-primary-600 hover:text-primary-800 font-semibold flex items-center mb-6 transition" onclick="event.preventDefault(); history.pushState(null, '', '/'); router();">
Â  Â  Â  Â  Â  Kembali ke Semua Produk
Â  Â  Â  Â  </a>
Â  Â  Â  Â  <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-12">
Â  Â  Â  Â  Â  <div class="flex flex-col lg:flex-row gap-10">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="lg:w-1/2">
Â  Â  Â  Â  Â  Â  Â  <div class="aspect-video bg-gray-100 rounded-xl overflow-hidden shadow-lg">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="${img}" alt="${escapeHtml(p.name)}" class="w-full h-full object-cover">
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="lg:w-1/2">
Â  Â  Â  Â  Â  Â  Â  <span class="inline-block text-xs font-bold text-primary-600 bg-primary-50 px-3 py-1 rounded-full mb-3 uppercase tracking-wider">${escapeHtml(p.category_name || 'Umum')}</span>
Â  Â  Â  Â  Â  Â  Â  <h2 class="text-4xl font-extrabold text-gray-900 mb-4">${escapeHtml(p.name)}</h2>
Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-baseline gap-4 mb-8 border-t border-b py-4">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-2xl font-bold text-gray-500">Harga:</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-4xl font-extrabold text-accent">Rp ${price}</span>
Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  <h3 class="text-2xl font-bold mb-4 text-gray-800">Deskripsi Produk</h3>
Â  Â  Â  Â  Â  Â  Â  <p class="text-gray-600 leading-relaxed whitespace-pre-wrap">${escapeHtml(p.description)}</p>

Â  Â  Â  Â  Â  Â  Â  <button onclick="alert('Checkout untuk ${escapeHtml(p.name)} akan segera diproses!')" class="mt-10 w-full inline-flex items-center justify-center gap-2 bg-accent text-white py-3.5 px-6 rounded-xl text-xl font-bold shadow-2xl hover:bg-green-600 focus:outline-none focus:ring-4 focus:ring-accent/50 transition duration-300">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="icon-cart"></span> Beli Sekarang
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  }

Â  Â  async function loadProductDetail(slug) {
Â  Â  Â  productDetailPage.innerHTML = '<div class="text-center p-10 bg-white rounded-xl shadow-lg">Memuat detail produk...</div>';
Â  Â  Â  productListPage.classList.add('hidden', 'opacity-0');
Â  Â  Â  productDetailPage.classList.remove('hidden', 'opacity-0');

Â  Â  Â  try {
Â  Â  Â  Â  const res = await fetch(`${API_PRODUCT_BY_SLUG}${encodeURIComponent(slug)}`);
Â  Â  Â  Â  const parsed = await parseJsonResponse(res);

Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  productDetailPage.innerHTML = `
Â  Â  Â  Â  Â  Â  <div class="text-center p-20 bg-white rounded-xl shadow-lg">
Â  Â  Â  Â  Â  Â  Â  <p class="text-3xl font-bold text-red-500 mb-4">404</p>
Â  Â  Â  Â  Â  Â  Â  <p class="text-xl text-gray-700">Produk **${escapeHtml(slug)}** tidak ditemukan.</p>
Â  Â  Â  Â  Â  Â  Â  <a href="/" class="mt-6 icon-back inline-flex items-center text-primary-600 hover:text-primary-800 font-semibold transition" onclick="event.preventDefault(); history.pushState(null, '', '/'); router();">
Â  Â  Â  Â  Â  Â  Â  Â  Kembali ke Beranda
Â  Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  pageTitleEl.textContent = '404 - Tidak Ditemukan';
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  renderProductDetail(parsed.json);

Â  Â  Â  } catch (err) {
Â  Â  Â  Â  console.error('Unexpected error loading product detail', err);
Â  Â  Â  Â  productDetailPage.innerHTML = '<div class="text-center p-10 bg-red-50 rounded-xl shadow border border-red-200 text-red-700 font-medium">Terjadi kesalahan server saat memuat detail produk.</div>';
Â  Â  Â  }
Â  Â  }

Â  Â  // --- Client-Side Router ---

Â  Â  function router() {
Â  Â  Â  const path = window.location.pathname;
Â  Â  Â  const match = path.match(/^\/product\/([^/]+)$/);

Â  Â  Â  if (match) {
Â  Â  Â  Â  // Rute: /product/:slug
Â  Â  Â  Â  const slug = decodeURIComponent(match[1]);
Â  Â  Â  Â  loadProductDetail(slug);
Â  Â  Â  } else {
Â  Â  Â  Â  // Rute: / atau lainnya (kembali ke daftar produk)
Â  Â  Â  Â  loadProducts();
Â  Â  Â  }
Â  Â  }

Â  Â  // Panggil router saat halaman dimuat dan ketika menggunakan tombol back/forward browser
Â  Â  window.addEventListener('popstate', router);
Â  Â  searchInput.addEventListener('input', (() => { let t; return () => { clearTimeout(t); t = setTimeout(()=>applySearch(products), 250); }; })());

Â  Â  // Memastikan link internal yang mengarah ke home menggunakan router
Â  Â  document.querySelector('header a[href="/"]').addEventListener('click', (e) => {
Â  Â  Â  e.preventDefault();
Â  Â  Â  history.pushState(null, '', '/');
Â  Â  Â  router();
Â  Â  });

Â  Â  router();
Â  </script>
</body>
</html>
